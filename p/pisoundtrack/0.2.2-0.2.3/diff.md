# Comparing `tmp/pisoundtrack-0.2.2.tar.gz` & `tmp/pisoundtrack-0.2.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pisoundtrack-0.2.2.tar", last modified: Tue May 17 07:32:43 2022, max compression
+gzip compressed data, was "pisoundtrack-0.2.3.tar", last modified: Thu Jun  1 13:10:00 2023, max compression
```

## Comparing `pisoundtrack-0.2.2.tar` & `pisoundtrack-0.2.3.tar`

### file list

```diff
@@ -1,15 +1,16 @@
-drwxrwxrwx   0        0        0        0 2022-05-17 07:32:43.260103 pisoundtrack-0.2.2/
--rw-rw-rw-   0        0        0      605 2022-05-17 07:32:43.260103 pisoundtrack-0.2.2/PKG-INFO
--rw-rw-rw-   0        0        0       64 2021-12-27 12:06:52.000000 pisoundtrack-0.2.2/README.md
-drwxrwxrwx   0        0        0        0 2022-05-17 07:32:43.222327 pisoundtrack-0.2.2/pisoundtrack/
--rw-rw-rw-   0        0        0       30 2021-01-18 15:30:59.000000 pisoundtrack-0.2.2/pisoundtrack/__init__.py
--rw-rw-rw-   0        0        0      387 2022-05-17 07:28:44.000000 pisoundtrack-0.2.2/pisoundtrack/config-template.yml
--rw-rw-rw-   0        0        0     4292 2022-05-17 07:31:16.000000 pisoundtrack-0.2.2/pisoundtrack/soundtrack.py
-drwxrwxrwx   0        0        0        0 2022-05-17 07:32:43.260103 pisoundtrack-0.2.2/pisoundtrack.egg-info/
--rw-rw-rw-   0        0        0      605 2022-05-17 07:32:43.000000 pisoundtrack-0.2.2/pisoundtrack.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      282 2022-05-17 07:32:43.000000 pisoundtrack-0.2.2/pisoundtrack.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2022-05-17 07:32:43.000000 pisoundtrack-0.2.2/pisoundtrack.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       56 2022-05-17 07:32:43.000000 pisoundtrack-0.2.2/pisoundtrack.egg-info/requires.txt
--rw-rw-rw-   0        0        0       13 2022-05-17 07:32:43.000000 pisoundtrack-0.2.2/pisoundtrack.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2022-05-17 07:32:43.260103 pisoundtrack-0.2.2/setup.cfg
--rw-rw-rw-   0        0        0      911 2022-05-17 07:29:10.000000 pisoundtrack-0.2.2/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-01 13:10:00.670876 pisoundtrack-0.2.3/
+-rw-r--r--   0 runner    (1001) docker     (123)    35149 2023-06-01 13:09:48.000000 pisoundtrack-0.2.3/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)      582 2023-06-01 13:10:00.670876 pisoundtrack-0.2.3/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)       62 2023-06-01 13:09:48.000000 pisoundtrack-0.2.3/README.md
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-01 13:10:00.670876 pisoundtrack-0.2.3/pisoundtrack/
+-rw-r--r--   0 runner    (1001) docker     (123)       29 2023-06-01 13:09:48.000000 pisoundtrack-0.2.3/pisoundtrack/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      118 2023-06-01 13:09:48.000000 pisoundtrack-0.2.3/pisoundtrack/config-template.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     4852 2023-06-01 13:09:48.000000 pisoundtrack-0.2.3/pisoundtrack/soundtrack.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-01 13:10:00.670876 pisoundtrack-0.2.3/pisoundtrack.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)      582 2023-06-01 13:10:00.000000 pisoundtrack-0.2.3/pisoundtrack.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)      290 2023-06-01 13:10:00.000000 pisoundtrack-0.2.3/pisoundtrack.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-01 13:10:00.000000 pisoundtrack-0.2.3/pisoundtrack.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       63 2023-06-01 13:10:00.000000 pisoundtrack-0.2.3/pisoundtrack.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       13 2023-06-01 13:10:00.000000 pisoundtrack-0.2.3/pisoundtrack.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       38 2023-06-01 13:10:00.670876 pisoundtrack-0.2.3/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)      899 2023-06-01 13:09:48.000000 pisoundtrack-0.2.3/setup.py
```

### Comparing `pisoundtrack-0.2.2/pisoundtrack/soundtrack.py` & `pisoundtrack-0.2.3/pisoundtrack/soundtrack.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,269 +1,304 @@
-00000000: 0d0a 6672 6f6d 2069 6e66 6c75 7864 6220  ..from influxdb 
-00000010: 696d 706f 7274 2049 6e66 6c75 7844 4243  import InfluxDBC
-00000020: 6c69 656e 742c 2063 6c69 656e 740d 0a66  lient, client..f
-00000030: 726f 6d20 6261 7365 7574 696c 735f 7068  rom baseutils_ph
-00000040: 6f72 6e65 6520 696d 706f 7274 204d 616e  ornee import Man
-00000050: 6167 6564 436c 6173 730d 0a66 726f 6d20  agedClass..from 
-00000060: 6261 7365 7574 696c 735f 7068 6f72 6e65  baseutils_phorne
-00000070: 6520 696d 706f 7274 204c 6f67 6765 720d  e import Logger.
-00000080: 0a66 726f 6d20 6261 7365 7574 696c 735f  .from baseutils_
-00000090: 7068 6f72 6e65 6520 696d 706f 7274 2043  phornee import C
-000000a0: 6f6e 6669 670d 0a66 726f 6d20 6461 7465  onfig..from date
-000000b0: 7469 6d65 2069 6d70 6f72 7420 6461 7465  time import date
-000000c0: 7469 6d65 0d0a 696d 706f 7274 206d 6174  time..import mat
-000000d0: 680d 0a69 6d70 6f72 7420 7374 7275 6374  h..import struct
-000000e0: 0d0a 0d0a 636c 6173 7320 536f 756e 6474  ....class Soundt
-000000f0: 7261 636b 284d 616e 6167 6564 436c 6173  rack(ManagedClas
-00000100: 7329 3a0d 0a0d 0a20 2020 2064 6566 205f  s):....    def _
-00000110: 5f69 6e69 745f 5f28 7365 6c66 293a 0d0a  _init__(self):..
-00000120: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00000130: 5f5f 696e 6974 5f5f 2865 7865 6370 6174  __init__(execpat
-00000140: 683d 5f5f 6669 6c65 5f5f 290d 0a0d 0a20  h=__file__).... 
-00000150: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
-00000160: 6572 203d 204c 6f67 6765 7228 7b27 6d6f  er = Logger({'mo
-00000170: 6475 6c65 6e61 6d65 273a 2073 656c 662e  dulename': self.
-00000180: 6765 7443 6c61 7373 4e61 6d65 2829 2c20  getClassName(), 
-00000190: 276c 6f67 7061 7468 273a 2027 6c6f 6727  'logpath': 'log'
-000001a0: 2c20 276c 6f67 6e61 6d65 273a 2027 736f  , 'logname': 'so
-000001b0: 756e 6474 7261 636b 277d 290d 0a20 2020  undtrack'})..   
-000001c0: 2020 2020 2073 656c 662e 636f 6e66 6967       self.config
-000001d0: 203d 2043 6f6e 6669 6728 7b27 6d6f 6475   = Config({'modu
-000001e0: 6c65 6e61 6d65 273a 2073 656c 662e 6765  lename': self.ge
-000001f0: 7443 6c61 7373 4e61 6d65 2829 2c20 2765  tClassName(), 'e
-00000200: 7865 6370 6174 6827 3a20 5f5f 6669 6c65  xecpath': __file
-00000210: 5f5f 7d29 0d0a 0d0a 2020 2020 2020 2020  __})....        
-00000220: 686f 7374 203d 2073 656c 662e 636f 6e66  host = self.conf
-00000230: 6967 5b27 696e 666c 7578 6462 636f 6e6e  ig['influxdbconn
-00000240: 275d 5b27 686f 7374 275d 0d0a 2020 2020  ']['host']..    
-00000250: 2020 2020 7573 6572 203d 2073 656c 662e      user = self.
-00000260: 636f 6e66 6967 5b27 696e 666c 7578 6462  config['influxdb
-00000270: 636f 6e6e 275d 5b27 7573 6572 275d 0d0a  conn']['user']..
-00000280: 2020 2020 2020 2020 7061 7373 776f 7264          password
-00000290: 203d 2073 656c 662e 636f 6e66 6967 5b27   = self.config['
-000002a0: 696e 666c 7578 6462 636f 6e6e 275d 5b27  influxdbconn']['
-000002b0: 7061 7373 776f 7264 275d 0d0a 2020 2020  password']..    
-000002c0: 2020 2020 6275 636b 6574 203d 2073 656c      bucket = sel
-000002d0: 662e 636f 6e66 6967 5b27 696e 666c 7578  f.config['influx
-000002e0: 6462 636f 6e6e 275d 5b27 6275 636b 6574  dbconn']['bucket
-000002f0: 275d 0d0a 0d0a 2020 2020 2020 2020 7365  ']....        se
-00000300: 6c66 2e63 6f6e 6e20 3d20 496e 666c 7578  lf.conn = Influx
-00000310: 4442 436c 6965 6e74 2868 6f73 743d 686f  DBClient(host=ho
-00000320: 7374 2c20 7573 6572 6e61 6d65 3d75 7365  st, username=use
-00000330: 722c 2070 6173 7377 6f72 643d 7061 7373  r, password=pass
-00000340: 776f 7264 2c20 6461 7461 6261 7365 3d62  word, database=b
-00000350: 7563 6b65 7429 0d0a 0d0a 2020 2020 4063  ucket)....    @c
-00000360: 6c61 7373 6d65 7468 6f64 0d0a 2020 2020  lassmethod..    
-00000370: 6465 6620 6765 7443 6c61 7373 4e61 6d65  def getClassName
-00000380: 2863 6c73 293a 0d0a 2020 2020 2020 2020  (cls):..        
-00000390: 7265 7475 726e 2022 736f 756e 6474 7261  return "soundtra
-000003a0: 636b 220d 0a0d 0a20 2020 2064 6566 2067  ck"....    def g
-000003b0: 6574 5f72 6d73 2873 656c 662c 2062 6c6f  et_rms(self, blo
-000003c0: 636b 293a 0d0a 2020 2020 2020 2020 2320  ck):..        # 
-000003d0: 524d 5320 616d 706c 6974 7564 6520 6973  RMS amplitude is
-000003e0: 2064 6566 696e 6564 2061 7320 7468 6520   defined as the 
-000003f0: 7371 7561 7265 2072 6f6f 7420 6f66 2074  square root of t
-00000400: 6865 0d0a 2020 2020 2020 2020 2320 6d65  he..        # me
-00000410: 616e 206f 7665 7220 7469 6d65 206f 6620  an over time of 
-00000420: 7468 6520 7371 7561 7265 206f 6620 7468  the square of th
-00000430: 6520 616d 706c 6974 7564 652e 0d0a 0d0a  e amplitude.....
-00000440: 2020 2020 2020 2020 5348 4f52 545f 4e4f          SHORT_NO
-00000450: 524d 414c 495a 4520 3d20 2831 2e30 202f  RMALIZE = (1.0 /
-00000460: 2033 3237 3638 2e30 290d 0a0d 0a20 2020   32768.0)....   
-00000470: 2020 2020 2023 2069 7465 7261 7465 206f       # iterate o
-00000480: 7665 7220 7468 6520 626c 6f63 6b2e 0d0a  ver the block...
-00000490: 2020 2020 2020 2020 7375 6d5f 7371 7561          sum_squa
-000004a0: 7265 7320 3d20 302e 300d 0a20 2020 2020  res = 0.0..     
-000004b0: 2020 2066 6f72 2073 616d 706c 6520 696e     for sample in
-000004c0: 2062 6c6f 636b 3a0d 0a20 2020 2020 2020   block:..       
-000004d0: 2020 2020 206e 6f72 6d5f 7361 6d70 6c65       norm_sample
-000004e0: 203d 2073 616d 706c 6520 2a20 5348 4f52   = sample * SHOR
-000004f0: 545f 4e4f 524d 414c 495a 450d 0a20 2020  T_NORMALIZE..   
-00000500: 2020 2020 2020 2020 2073 756d 5f73 7175           sum_squ
-00000510: 6172 6573 202b 3d20 6e6f 726d 5f73 616d  ares += norm_sam
-00000520: 706c 6520 2a20 6e6f 726d 5f73 616d 706c  ple * norm_sampl
-00000530: 650d 0a0d 0a20 2020 2020 2020 2072 6574  e....        ret
-00000540: 7572 6e20 6d61 7468 2e73 7172 7428 7375  urn math.sqrt(su
-00000550: 6d5f 7371 7561 7265 7320 2f20 626c 6f63  m_squares / bloc
-00000560: 6b2e 7369 7a65 2920 2f20 5348 4f52 545f  k.size) / SHORT_
-00000570: 4e4f 524d 414c 495a 450d 0a0d 0a0d 0a20  NORMALIZE...... 
-00000580: 2020 2064 6566 2073 656e 736f 7252 6561     def sensorRea
-00000590: 6428 7365 6c66 293a 0d0a 2020 2020 2020  d(self):..      
-000005a0: 2020 2222 220d 0a20 2020 2020 2020 2052    """..        R
-000005b0: 6561 6420 7365 6e73 6f72 7320 696e 666f  ead sensors info
-000005c0: 726d 6174 696f 6e0d 0a20 2020 2020 2020  rmation..       
-000005d0: 2022 2222 0d0a 2020 2020 2020 2020 6861   """..        ha
-000005e0: 7665 5f72 6561 6469 6e67 7320 3d20 4661  ve_readings = Fa
-000005f0: 6c73 650d 0a0d 0a20 2020 2020 2020 2069  lse....        i
-00000600: 6d70 6f72 7420 6e75 6d70 790d 0a20 2020  mport numpy..   
-00000610: 2020 2020 2069 6d70 6f72 7420 7079 6175       import pyau
-00000620: 6469 6f0d 0a0d 0a20 2020 2020 2020 2070  dio....        p
-00000630: 7269 6e74 2822 496e 6974 6961 6c69 7a69  rint("Initializi
-00000640: 6e67 2050 7961 7564 696f 2e2e 2e2e 2229  ng Pyaudio....")
-00000650: 0d0a 2020 2020 2020 2020 7079 6175 6420  ..        pyaud 
-00000660: 3d20 7079 6175 6469 6f2e 5079 4175 6469  = pyaudio.PyAudi
-00000670: 6f28 290d 0a0d 0a20 2020 2020 2020 2064  o()....        d
-00000680: 6576 6963 655f 6e61 6d65 203d 2075 2757  evice_name = u'W
-00000690: 6f72 6446 6f72 756d 2055 5342 3a20 4175  ordForum USB: Au
-000006a0: 6469 6f20 2868 773a 322c 3029 270d 0a20  dio (hw:2,0)'.. 
-000006b0: 2020 2020 2020 2064 6576 6963 655f 7261         device_ra
-000006c0: 7465 203d 2030 0d0a 0d0a 2020 2020 2020  te = 0....      
-000006d0: 2020 7072 696e 7428 2247 6574 7469 6e67    print("Getting
-000006e0: 2064 6576 6963 6573 2e2e 2e22 290d 0a20   devices...").. 
-000006f0: 2020 2020 2020 2069 6e66 6f20 3d20 7079         info = py
-00000700: 6175 642e 6765 745f 686f 7374 5f61 7069  aud.get_host_api
-00000710: 5f69 6e66 6f5f 6279 5f69 6e64 6578 2830  _info_by_index(0
-00000720: 290d 0a20 2020 2020 2020 206e 756d 6465  )..        numde
-00000730: 7669 6365 7320 3d20 696e 666f 2e67 6574  vices = info.get
-00000740: 2827 6465 7669 6365 436f 756e 7427 290d  ('deviceCount').
-00000750: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
-00000760: 6576 6963 6520 3d20 2d31 0d0a 2020 2020  evice = -1..    
-00000770: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00000780: 6765 2830 2c20 6e75 6d64 6576 6963 6573  ge(0, numdevices
-00000790: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000007a0: 6465 7669 6365 5f69 6e66 6f20 3d20 7079  device_info = py
-000007b0: 6175 642e 6765 745f 6465 7669 6365 5f69  aud.get_device_i
-000007c0: 6e66 6f5f 6279 5f68 6f73 745f 6170 695f  nfo_by_host_api_
-000007d0: 6465 7669 6365 5f69 6e64 6578 2830 2c20  device_index(0, 
-000007e0: 6929 0d0a 2020 2020 2020 2020 2020 2020  i)..            
-000007f0: 7072 696e 7428 2245 7661 6c75 6174 696e  print("Evaluatin
-00000800: 6720 6465 7669 6365 207b 7d2e 2e2e 222e  g device {}...".
-00000810: 666f 726d 6174 2864 6576 6963 655f 696e  format(device_in
-00000820: 666f 2e67 6574 2827 6e61 6d65 2729 2929  fo.get('name')))
-00000830: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00000840: 2064 6576 6963 655f 696e 666f 2e67 6574   device_info.get
-00000850: 2827 6e61 6d65 2729 203d 3d20 6465 7669  ('name') == devi
-00000860: 6365 5f6e 616d 653a 0d0a 2020 2020 2020  ce_name:..      
-00000870: 2020 2020 2020 2020 2020 6966 2028 6465            if (de
-00000880: 7669 6365 5f69 6e66 6f2e 6765 7428 276d  vice_info.get('m
-00000890: 6178 496e 7075 7443 6861 6e6e 656c 7327  axInputChannels'
-000008a0: 2929 203e 2030 3a0d 0a20 2020 2020 2020  )) > 0:..       
-000008b0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-000008c0: 706c 696e 675f 7261 7465 203d 2069 6e74  pling_rate = int
-000008d0: 2864 6576 6963 655f 696e 666f 2e67 6574  (device_info.get
-000008e0: 2827 6465 6661 756c 7453 616d 706c 6552  ('defaultSampleR
-000008f0: 6174 6527 2929 0d0a 2020 2020 2020 2020  ate'))..        
-00000900: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00000910: 7428 2249 6e70 7574 2044 6576 6963 6520  t("Input Device 
-00000920: 6964 207b 7d20 2d20 7b7d 222e 666f 726d  id {} - {}".form
-00000930: 6174 2869 2c20 6465 7669 6365 5f69 6e66  at(i, device_inf
-00000940: 6f2e 6765 7428 276e 616d 6527 2929 290d  o.get('name'))).
-00000950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000960: 2020 2020 2070 7269 6e74 2822 5361 6d70       print("Samp
-00000970: 6c69 6e67 2052 6174 6520 2d20 7b7d 222e  ling Rate - {}".
-00000980: 666f 726d 6174 2873 616d 706c 696e 675f  format(sampling_
-00000990: 7261 7465 2929 0d0a 2020 2020 2020 2020  rate))..        
-000009a0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-000009b0: 745f 6465 7669 6365 203d 2069 0d0a 2020  t_device = i..  
-000009c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000009d0: 2020 6272 6561 6b0d 0a20 2020 2020 2020    break..       
-000009e0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-000009f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000a00: 2020 2020 7365 6c66 2e6c 6f67 6765 722e      self.logger.
-00000a10: 6572 726f 7228 2244 6576 6963 6520 7b7d  error("Device {}
-00000a20: 2068 6173 206e 6f20 696e 7075 7420 6368   has no input ch
-00000a30: 616e 6e65 6c73 2e22 2e66 6f72 6d61 7428  annels.".format(
-00000a40: 6465 7669 6365 5f6e 616d 6529 290d 0a0d  device_name))...
-00000a50: 0a20 2020 2020 2020 2069 6620 696e 7075  .        if inpu
-00000a60: 745f 6465 7669 6365 203d 3d20 2d31 3a0d  t_device == -1:.
-00000a70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00000a80: 662e 6c6f 6767 6572 2e65 7272 6f72 2822  f.logger.error("
-00000a90: 496e 7075 7420 4465 7669 6365 207b 7d20  Input Device {} 
-00000aa0: 6e6f 7420 666f 756e 642e 222e 666f 726d  not found.".form
-00000ab0: 6174 2864 6576 6963 655f 6e61 6d65 2929  at(device_name))
-00000ac0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00000ad0: 7475 726e 202d 310d 0a0d 0a20 2020 2020  turn -1....     
-00000ae0: 2020 2073 7472 6561 6d20 3d20 7079 6175     stream = pyau
-00000af0: 642e 6f70 656e 2866 6f72 6d61 743d 7079  d.open(format=py
-00000b00: 6175 6469 6f2e 7061 496e 7431 362c 2063  audio.paInt16, c
-00000b10: 6861 6e6e 656c 733d 312c 2072 6174 653d  hannels=1, rate=
-00000b20: 3434 3130 302c 2069 6e70 7574 5f64 6576  44100, input_dev
-00000b30: 6963 655f 696e 6465 783d 696e 7075 745f  ice_index=input_
-00000b40: 6465 7669 6365 2c20 696e 7075 743d 5472  device, input=Tr
-00000b50: 7565 290d 0a0d 0a20 2020 2020 2020 2077  ue)....        w
-00000b60: 6869 6c65 2054 7275 653a 0d0a 2020 2020  hile True:..    
-00000b70: 2020 2020 2020 2020 6e75 6d5f 7365 636f          num_seco
-00000b80: 6e64 7320 3d20 300d 0a20 2020 2020 2020  nds = 0..       
-00000b90: 2020 2020 206d 6178 5f72 6561 6420 3d20       max_read = 
-00000ba0: 300d 0a20 2020 2020 2020 2020 2020 2077  0..            w
-00000bb0: 6869 6c65 206e 756d 5f73 6563 6f6e 6473  hile num_seconds
-00000bc0: 203c 2036 303a 0d0a 2020 2020 2020 2020   < 60:..        
-00000bd0: 2020 2020 2020 2020 7261 7773 203d 2073          raws = s
-00000be0: 7472 6561 6d2e 7265 6164 2873 616d 706c  tream.read(sampl
-00000bf0: 696e 675f 7261 7465 3e3e 312c 2065 7863  ing_rate>>1, exc
-00000c00: 6570 7469 6f6e 5f6f 6e5f 6f76 6572 666c  eption_on_overfl
-00000c10: 6f77 3d46 616c 7365 290d 0a20 2020 2020  ow=False)..     
-00000c20: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-00000c30: 6573 203d 206e 756d 7079 2e66 726f 6d73  es = numpy.froms
-00000c40: 7472 696e 6728 7261 7773 2c20 6474 7970  tring(raws, dtyp
-00000c50: 653d 6e75 6d70 792e 696e 7431 3629 0d0a  e=numpy.int16)..
-00000c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c70: 726d 7320 3d20 7365 6c66 2e67 6574 5f72  rms = self.get_r
-00000c80: 6d73 2873 616d 706c 6573 290d 0a20 2020  ms(samples)..   
-00000c90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00000ca0: 726d 7320 3e20 6d61 785f 7265 6164 3a0d  rms > max_read:.
-00000cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000cc0: 2020 2020 206d 6178 5f72 6561 6420 3d20       max_read = 
-00000cd0: 726d 730d 0a20 2020 2020 2020 2020 2020  rms..           
-00000ce0: 2020 2020 2070 7269 6e74 2822 7b3a 2e32       print("{:.2
-00000cf0: 667d 222e 666f 726d 6174 2872 6d73 2929  f}".format(rms))
-00000d00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00000d10: 2020 6e75 6d5f 7365 636f 6e64 7320 2b3d    num_seconds +=
-00000d20: 2031 0d0a 0d0a 2020 2020 2020 2020 2020   1....          
-00000d30: 2020 6a73 6f6e 5f62 6f64 7920 3d20 5b0d    json_body = [.
-00000d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000d50: 207b 0d0a 2020 2020 2020 2020 2020 2020   {..            
-00000d60: 2020 2020 2020 2020 226d 6561 7375 7265          "measure
-00000d70: 6d65 6e74 223a 2022 736f 756e 6422 2c0d  ment": "sound",.
-00000d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000d90: 2020 2020 2022 7461 6773 223a 207b 0d0a       "tags": {..
-00000da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000db0: 2020 2020 2020 2020 2273 6f75 6e64 6964          "soundid
-00000dc0: 223a 2073 656c 662e 636f 6e66 6967 5b27  ": self.config['
-00000dd0: 6964 275d 0d0a 2020 2020 2020 2020 2020  id']..          
-00000de0: 2020 2020 2020 2020 2020 7d2c 0d0a 2020            },..  
-00000df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e00: 2020 2274 696d 6522 3a20 6461 7465 7469    "time": dateti
-00000e10: 6d65 2e75 7463 6e6f 7728 292c 0d0a 2020  me.utcnow(),..  
-00000e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e30: 2020 2266 6965 6c64 7322 3a20 7b0d 0a20    "fields": {.. 
-00000e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e50: 2020 2020 2020 2022 6d61 7822 3a20 666c         "max": fl
-00000e60: 6f61 7428 6d61 785f 7265 6164 290d 0a20  oat(max_read).. 
-00000e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000e80: 2020 207d 0d0a 2020 2020 2020 2020 2020     }..          
-00000e90: 2020 2020 2020 7d0d 0a20 2020 2020 2020        }..       
-00000ea0: 2020 2020 205d 0d0a 2020 2020 2020 2020       ]..        
-00000eb0: 2020 2020 2320 7472 793a 0d0a 2020 2020      # try:..    
-00000ec0: 2020 2020 2020 2020 2320 2020 2020 7365          #     se
-00000ed0: 6c66 2e63 6f6e 6e2e 7772 6974 655f 706f  lf.conn.write_po
-00000ee0: 696e 7473 286a 736f 6e5f 626f 6479 290d  ints(json_body).
-00000ef0: 0a20 2020 2020 2020 2020 2020 2023 0d0a  .            #..
-00000f00: 2020 2020 2020 2020 2020 2020 2320 6578              # ex
-00000f10: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
-00000f20: 7320 653a 0d0a 2020 2020 2020 2020 2020  s e:..          
-00000f30: 2020 2320 2020 2020 7365 6c66 2e6c 6f67    #     self.log
-00000f40: 6765 722e 6572 726f 7228 2252 756e 7469  ger.error("Runti
-00000f50: 6d65 4572 726f 723a 207b 7d22 2e66 6f72  meError: {}".for
-00000f60: 6d61 7428 6529 290d 0a20 2020 2020 2020  mat(e))..       
-00000f70: 2020 2020 2023 2020 2020 2073 656c 662e       #     self.
-00000f80: 6c6f 6767 6572 2e65 7272 6f72 2822 696e  logger.error("in
-00000f90: 666c 7578 4442 5552 4c3d 7b7d 207c 2069  fluxDBURL={} | i
-00000fa0: 6e66 6c75 7844 4254 6f6b 656e 3d7b 7d22  nfluxDBToken={}"
-00000fb0: 2e66 6f72 6d61 7428 7365 6c66 2e63 6f6e  .format(self.con
-00000fc0: 6669 675b 2769 6e66 6c75 7864 6263 6f6e  fig['influxdbcon
-00000fd0: 6e27 5d5b 2775 726c 275d 2c0d 0a20 2020  n']['url'],..   
-00000fe0: 2020 2020 2020 2020 2023 2020 2020 2020           #      
+00000000: 2222 2220 2222 220a 696d 706f 7274 206f  """ """.import o
+00000010: 730a 6672 6f6d 2064 6174 6574 696d 6520  s.from datetime 
+00000020: 696d 706f 7274 2064 6174 6574 696d 650a  import datetime.
+00000030: 6672 6f6d 2070 6174 686c 6962 2069 6d70  from pathlib imp
+00000040: 6f72 7420 5061 7468 0a69 6d70 6f72 7420  ort Path.import 
+00000050: 6d61 7468 0a0a 696d 706f 7274 206e 756d  math..import num
+00000060: 7079 0a69 6d70 6f72 7420 7079 6175 6469  py.import pyaudi
+00000070: 6f0a 0a66 726f 6d20 696e 666c 7578 6462  o..from influxdb
+00000080: 5f77 7261 7070 6572 2069 6d70 6f72 7420  _wrapper import 
+00000090: 696e 666c 7578 6462 5f66 6163 746f 7279  influxdb_factory
+000000a0: 0a66 726f 6d20 6c6f 675f 6d67 7220 696d  .from log_mgr im
+000000b0: 706f 7274 204c 6f67 6765 720a 6672 6f6d  port Logger.from
+000000c0: 2063 6f6e 6669 675f 796d 6c20 696d 706f   config_yml impo
+000000d0: 7274 2043 6f6e 6669 670a 0a53 484f 5254  rt Config..SHORT
+000000e0: 5f4e 4f52 4d41 4c49 5a45 203d 2028 312e  _NORMALIZE = (1.
+000000f0: 3020 2f20 3332 3736 382e 3029 0a49 4e50  0 / 32768.0).INP
+00000100: 5554 5f42 4c4f 434b 5f54 494d 4520 3d20  UT_BLOCK_TIME = 
+00000110: 302e 3130 0a53 494c 454e 4345 5f53 414d  0.10.SILENCE_SAM
+00000120: 504c 455f 4c45 5645 4c20 3d20 3235 310a  PLE_LEVEL = 251.
+00000130: 4d49 4e5f 4155 4449 424c 455f 4c45 5645  MIN_AUDIBLE_LEVE
+00000140: 4c20 3d20 302e 3030 3732 3720 2023 2032  L = 0.00727  # 2
+00000150: 3020 7550 6173 6361 6c73 0a0a 0a63 6c61  0 uPascals...cla
+00000160: 7373 2053 6f75 6e64 7472 6163 6b28 293a  ss Soundtrack():
+00000170: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00000180: 5f28 7365 6c66 2c20 6472 795f 7275 6e3a  _(self, dry_run:
+00000190: 2062 6f6f 6c20 3d20 4661 6c73 6529 3a0a   bool = False):.
+000001a0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+000001b0: 6765 7220 3d20 4c6f 6767 6572 2873 656c  ger = Logger(sel
+000001c0: 662e 636c 6173 735f 6e61 6d65 2829 2c20  f.class_name(), 
+000001d0: 2773 6f75 6e64 7472 6163 6b27 2c20 6472  'soundtrack', dr
+000001e0: 795f 7275 6e3d 6472 795f 7275 6e29 0a20  y_run=dry_run). 
+000001f0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00000200: 6572 2e69 6e66 6f28 2249 6e69 7469 616c  er.info("Initial
+00000210: 697a 696e 6720 536f 756e 6474 7261 636b  izing Soundtrack
+00000220: 2e2e 2e22 290a 2020 2020 2020 2020 7465  ...").        te
+00000230: 6d70 6c61 7465 5f63 6f6e 6669 675f 7061  mplate_config_pa
+00000240: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
+00000250: 6e28 5061 7468 285f 5f66 696c 655f 5f29  n(Path(__file__)
+00000260: 2e70 6172 656e 742e 7265 736f 6c76 6528  .parent.resolve(
+00000270: 292c 2027 2e2f 636f 6e66 6967 2d74 656d  ), './config-tem
+00000280: 706c 6174 652e 796d 6c27 290a 0a20 2020  plate.yml')..   
+00000290: 2020 2020 2073 656c 662e 636f 6e66 6967       self.config
+000002a0: 203d 2043 6f6e 6669 6728 7061 636b 6167   = Config(packag
+000002b0: 655f 6e61 6d65 3d73 656c 662e 636c 6173  e_name=self.clas
+000002c0: 735f 6e61 6d65 2829 2c0a 2020 2020 2020  s_name(),.      
+000002d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000002e0: 2020 2020 2020 2074 656d 706c 6174 655f         template_
+000002f0: 7061 7468 3d74 656d 706c 6174 655f 636f  path=template_co
+00000300: 6e66 6967 5f70 6174 682c 0a20 2020 2020  nfig_path,.     
+00000310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000320: 2020 2020 2020 2020 636f 6e66 6967 5f66          config_f
+00000330: 696c 655f 6e61 6d65 3d22 636f 6e66 6967  ile_name="config
+00000340: 2e79 6d6c 2229 0a0a 2020 2020 2020 2020  .yml")..        
+00000350: 696e 666c 7578 5f63 6f6e 6e5f 7479 7065  influx_conn_type
+00000360: 203d 2073 656c 662e 636f 6e66 6967 5b27   = self.config['
+00000370: 696e 666c 7578 6462 636f 6e6e 275d 2e67  influxdbconn'].g
+00000380: 6574 2827 7479 7065 272c 2027 696e 666c  et('type', 'infl
+00000390: 7578 2729 0a20 2020 2020 2020 2073 656c  ux').        sel
+000003a0: 662e 636f 6e6e 203d 2069 6e66 6c75 7864  f.conn = influxd
+000003b0: 625f 6661 6374 6f72 7928 696e 666c 7578  b_factory(influx
+000003c0: 5f63 6f6e 6e5f 7479 7065 290a 2020 2020  _conn_type).    
+000003d0: 2020 2020 7365 6c66 2e63 6f6e 6e2e 6f70      self.conn.op
+000003e0: 656e 436f 6e6e 2873 656c 662e 636f 6e66  enConn(self.conf
+000003f0: 6967 5b27 696e 666c 7578 6462 636f 6e6e  ig['influxdbconn
+00000400: 275d 290a 0a20 2020 2040 636c 6173 736d  '])..    @classm
+00000410: 6574 686f 640a 2020 2020 6465 6620 636c  ethod.    def cl
+00000420: 6173 735f 6e61 6d65 2863 6c73 293a 0a20  ass_name(cls):. 
+00000430: 2020 2020 2020 2072 6574 7572 6e20 2273         return "s
+00000440: 6f75 6e64 7472 6163 6b22 0a0a 2020 2020  oundtrack"..    
+00000450: 6465 6620 6765 745f 726d 7328 7365 6c66  def get_rms(self
+00000460: 2c20 626c 6f63 6b29 3a0a 2020 2020 2020  , block):.      
+00000470: 2020 2320 524d 5320 616d 706c 6974 7564    # RMS amplitud
+00000480: 6520 6973 2064 6566 696e 6564 2061 7320  e is defined as 
+00000490: 7468 6520 7371 7561 7265 2072 6f6f 7420  the square root 
+000004a0: 6f66 2074 6865 0a20 2020 2020 2020 2023  of the.        #
+000004b0: 206d 6561 6e20 6f76 6572 2074 696d 6520   mean over time 
+000004c0: 6f66 2074 6865 2073 7175 6172 6520 6f66  of the square of
+000004d0: 2074 6865 2061 6d70 6c69 7475 6465 2e0a   the amplitude..
+000004e0: 0a20 2020 2020 2020 2023 2053 484f 5254  .        # SHORT
+000004f0: 5f4e 4f52 4d41 4c49 5a45 203d 2028 312e  _NORMALIZE = (1.
+00000500: 3020 2f20 3332 3736 382e 3029 0a20 2020  0 / 32768.0).   
+00000510: 2020 2020 2053 484f 5254 5f4e 4f52 4d41       SHORT_NORMA
+00000520: 4c49 5a45 203d 2028 312e 3020 2f20 3236  LIZE = (1.0 / 26
+00000530: 3030 302e 3029 0a0a 2020 2020 2020 2020  000.0)..        
+00000540: 2320 6974 6572 6174 6520 6f76 6572 2074  # iterate over t
+00000550: 6865 2062 6c6f 636b 2e0a 2020 2020 2020  he block..      
+00000560: 2020 7375 6d5f 7371 7561 7265 7320 3d20    sum_squares = 
+00000570: 302e 300a 2020 2020 2020 2020 666f 7220  0.0.        for 
+00000580: 7361 6d70 6c65 2069 6e20 626c 6f63 6b3a  sample in block:
+00000590: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
+000005a0: 6d5f 7361 6d70 6c65 203d 2073 616d 706c  m_sample = sampl
+000005b0: 6520 2a20 5348 4f52 545f 4e4f 524d 414c  e * SHORT_NORMAL
+000005c0: 495a 450a 2020 2020 2020 2020 2020 2020  IZE.            
+000005d0: 7375 6d5f 7371 7561 7265 7320 2b3d 206e  sum_squares += n
+000005e0: 6f72 6d5f 7361 6d70 6c65 202a 206e 6f72  orm_sample * nor
+000005f0: 6d5f 7361 6d70 6c65 0a0a 2020 2020 2020  m_sample..      
+00000600: 2020 7265 7475 726e 206d 6174 682e 7371    return math.sq
+00000610: 7274 2873 756d 5f73 7175 6172 6573 202f  rt(sum_squares /
+00000620: 2062 6c6f 636b 2e73 697a 6529 0a0a 2020   block.size)..  
+00000630: 2020 6465 6620 7365 6e73 6f72 5265 6164    def sensorRead
+00000640: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00000650: 2222 220a 2020 2020 2020 2020 5265 6164  """.        Read
+00000660: 2073 656e 736f 7273 2069 6e66 6f72 6d61   sensors informa
+00000670: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00000680: 0a20 2020 2020 2020 2068 6176 655f 7265  .        have_re
+00000690: 6164 696e 6773 203d 2046 616c 7365 0a0a  adings = False..
+000006a0: 2020 2020 2020 2020 7072 696e 7428 2249          print("I
+000006b0: 6e69 7469 616c 697a 696e 6720 5079 6175  nitializing Pyau
+000006c0: 6469 6f2e 2e2e 2e22 290a 2020 2020 2020  dio....").      
+000006d0: 2020 7365 6c66 2e6c 6f67 6765 722e 696e    self.logger.in
+000006e0: 666f 2822 496e 6974 6961 6c69 7a69 6e67  fo("Initializing
+000006f0: 2050 7961 7564 696f 2e2e 2e22 290a 2020   Pyaudio...").  
+00000700: 2020 2020 2020 7079 6175 6420 3d20 7079        pyaud = py
+00000710: 6175 6469 6f2e 5079 4175 6469 6f28 290a  audio.PyAudio().
+00000720: 0a20 2020 2020 2020 2064 6576 6963 655f  .        device_
+00000730: 6e61 6d65 203d 2075 2757 6f72 6446 6f72  name = u'WordFor
+00000740: 756d 2055 5342 3a20 4175 6469 6f27 0a0a  um USB: Audio'..
+00000750: 2020 2020 2020 2020 7072 696e 7428 2247          print("G
+00000760: 6574 7469 6e67 2064 6576 6963 6573 2e2e  etting devices..
+00000770: 2e22 290a 2020 2020 2020 2020 696e 666f  .").        info
+00000780: 203d 2070 7961 7564 2e67 6574 5f68 6f73   = pyaud.get_hos
+00000790: 745f 6170 695f 696e 666f 5f62 795f 696e  t_api_info_by_in
+000007a0: 6465 7828 3029 0a20 2020 2020 2020 206e  dex(0).        n
+000007b0: 756d 5f64 6576 6963 6573 203d 2069 6e66  um_devices = inf
+000007c0: 6f2e 6765 7428 2764 6576 6963 6543 6f75  o.get('deviceCou
+000007d0: 6e74 2729 0a20 2020 2020 2020 2069 6e70  nt').        inp
+000007e0: 7574 5f64 6576 6963 6520 3d20 2d31 0a20  ut_device = -1. 
+000007f0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00000800: 7261 6e67 6528 302c 206e 756d 5f64 6576  range(0, num_dev
+00000810: 6963 6573 293a 0a20 2020 2020 2020 2020  ices):.         
+00000820: 2020 2064 6576 6963 655f 696e 666f 203d     device_info =
+00000830: 2070 7961 7564 2e67 6574 5f64 6576 6963   pyaud.get_devic
+00000840: 655f 696e 666f 5f62 795f 686f 7374 5f61  e_info_by_host_a
+00000850: 7069 5f64 6576 6963 655f 696e 6465 7828  pi_device_index(
+00000860: 302c 2069 290a 2020 2020 2020 2020 2020  0, i).          
+00000870: 2020 7072 696e 7428 6622 4576 616c 7561    print(f"Evalua
+00000880: 7469 6e67 2064 6576 6963 6520 7b64 6576  ting device {dev
+00000890: 6963 655f 696e 666f 2e67 6574 2827 6e61  ice_info.get('na
+000008a0: 6d65 2729 7d2e 2e2e 2229 0a20 2020 2020  me')}...").     
+000008b0: 2020 2020 2020 2069 6620 6465 7669 6365         if device
+000008c0: 5f69 6e66 6f2e 6765 7428 276e 616d 6527  _info.get('name'
+000008d0: 292e 7374 6172 7473 7769 7468 2864 6576  ).startswith(dev
+000008e0: 6963 655f 6e61 6d65 293a 0a20 2020 2020  ice_name):.     
+000008f0: 2020 2020 2020 2020 2020 2069 6620 2864             if (d
+00000900: 6576 6963 655f 696e 666f 2e67 6574 2827  evice_info.get('
+00000910: 6d61 7849 6e70 7574 4368 616e 6e65 6c73  maxInputChannels
+00000920: 2729 2920 3e20 303a 0a20 2020 2020 2020  ')) > 0:.       
+00000930: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+00000940: 706c 696e 675f 7261 7465 203d 2069 6e74  pling_rate = int
+00000950: 2864 6576 6963 655f 696e 666f 2e67 6574  (device_info.get
+00000960: 2827 6465 6661 756c 7453 616d 706c 6552  ('defaultSampleR
+00000970: 6174 6527 2929 0a20 2020 2020 2020 2020  ate')).         
+00000980: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00000990: 2866 2249 6e70 7574 2044 6576 6963 6520  (f"Input Device 
+000009a0: 6964 207b 697d 202d 207b 6465 7669 6365  id {i} - {device
+000009b0: 5f69 6e66 6f2e 6765 7428 276e 616d 6527  _info.get('name'
+000009c0: 297d 2229 0a20 2020 2020 2020 2020 2020  )}").           
+000009d0: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+000009e0: 2253 616d 706c 696e 6720 5261 7465 202d  "Sampling Rate -
+000009f0: 207b 7361 6d70 6c69 6e67 5f72 6174 657d   {sampling_rate}
+00000a00: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00000a10: 2020 2020 2020 2069 6e70 7574 5f64 6576         input_dev
+00000a20: 6963 6520 3d20 690a 2020 2020 2020 2020  ice = i.        
+00000a30: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00000a40: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
+00000a50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00000a60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00000a70: 2e6c 6f67 6765 722e 6572 726f 7228 6622  .logger.error(f"
+00000a80: 4465 7669 6365 207b 6465 7669 6365 5f6e  Device {device_n
+00000a90: 616d 657d 2068 6173 206e 6f20 696e 7075  ame} has no inpu
+00000aa0: 7420 6368 616e 6e65 6c73 2e22 290a 0a20  t channels.").. 
+00000ab0: 2020 2020 2020 2069 6620 696e 7075 745f         if input_
+00000ac0: 6465 7669 6365 203d 3d20 2d31 3a0a 2020  device == -1:.  
+00000ad0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00000ae0: 6f67 6765 722e 6572 726f 7228 6622 496e  ogger.error(f"In
+00000af0: 7075 7420 4465 7669 6365 207b 6465 7669  put Device {devi
+00000b00: 6365 5f6e 616d 657d 206e 6f74 2066 6f75  ce_name} not fou
+00000b10: 6e64 2e22 290a 2020 2020 2020 2020 2020  nd.").          
+00000b20: 2020 7265 7475 726e 202d 310a 0a20 2020    return -1..   
+00000b30: 2020 2020 2069 6e70 7574 5f66 7261 6d65       input_frame
+00000b40: 735f 7065 725f 626c 6f63 6b20 3d20 696e  s_per_block = in
+00000b50: 7428 7361 6d70 6c69 6e67 5f72 6174 6520  t(sampling_rate 
+00000b60: 2a20 494e 5055 545f 424c 4f43 4b5f 5449  * INPUT_BLOCK_TI
+00000b70: 4d45 290a 0a20 2020 2020 2020 2073 7472  ME)..        str
+00000b80: 6561 6d20 3d20 7079 6175 642e 6f70 656e  eam = pyaud.open
+00000b90: 2866 6f72 6d61 743d 7079 6175 6469 6f2e  (format=pyaudio.
+00000ba0: 7061 496e 7431 362c 2063 6861 6e6e 656c  paInt16, channel
+00000bb0: 733d 312c 2072 6174 653d 7361 6d70 6c69  s=1, rate=sampli
+00000bc0: 6e67 5f72 6174 652c 2069 6e70 7574 5f64  ng_rate, input_d
+00000bd0: 6576 6963 655f 696e 6465 783d 696e 7075  evice_index=inpu
+00000be0: 745f 6465 7669 6365 2c0a 2020 2020 2020  t_device,.      
+00000bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c00: 2020 2020 2020 696e 7075 743d 5472 7565        input=True
+00000c10: 2c20 6672 616d 6573 5f70 6572 5f62 7566  , frames_per_buf
+00000c20: 6665 723d 696e 7075 745f 6672 616d 6573  fer=input_frames
+00000c30: 5f70 6572 5f62 6c6f 636b 290a 0a20 2020  _per_block)..   
+00000c40: 2020 2020 2077 6869 6c65 2054 7275 653a       while True:
+00000c50: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+00000c60: 5f73 6563 6f6e 6473 203d 2030 0a20 2020  _seconds = 0.   
+00000c70: 2020 2020 2020 2020 206d 6178 5f72 6561           max_rea
+00000c80: 6420 3d20 300a 2020 2020 2020 2020 2020  d = 0.          
+00000c90: 2020 7768 696c 6520 6e75 6d5f 7365 636f    while num_seco
+00000ca0: 6e64 7320 3c20 3630 3a0a 2020 2020 2020  nds < 60:.      
+00000cb0: 2020 2020 2020 2020 2020 7261 7720 3d20            raw = 
+00000cc0: 7374 7265 616d 2e72 6561 6428 696e 7075  stream.read(inpu
+00000cd0: 745f 6672 616d 6573 5f70 6572 5f62 6c6f  t_frames_per_blo
+00000ce0: 636b 2c20 6578 6365 7074 696f 6e5f 6f6e  ck, exception_on
+00000cf0: 5f6f 7665 7266 6c6f 773d 4661 6c73 6529  _overflow=False)
+00000d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000d10: 2073 616d 706c 6573 203d 206e 756d 7079   samples = numpy
+00000d20: 2e66 726f 6d62 7566 6665 7228 7261 772c  .frombuffer(raw,
+00000d30: 2064 7479 7065 3d6e 756d 7079 2e69 6e74   dtype=numpy.int
+00000d40: 3136 290a 2020 2020 2020 2020 2020 2020  16).            
+00000d50: 2020 2020 726d 7320 3d20 7365 6c66 2e67      rms = self.g
+00000d60: 6574 5f72 6d73 2873 616d 706c 6573 290a  et_rms(samples).
+00000d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000d80: 6966 2072 6d73 203e 206d 6178 5f72 6561  if rms > max_rea
+00000d90: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00000da0: 2020 2020 2020 206d 6178 5f72 6561 6420         max_read 
+00000db0: 3d20 726d 730a 2020 2020 2020 2020 2020  = rms.          
+00000dc0: 2020 2020 2020 7072 696e 7428 227b 3a2e        print("{:.
+00000dd0: 3266 7d22 2e66 6f72 6d61 7428 726d 7329  2f}".format(rms)
+00000de0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00000df0: 2020 6e75 6d5f 7365 636f 6e64 7320 2b3d    num_seconds +=
+00000e00: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
+00000e10: 2320 4465 6369 6265 6c20 636f 6e76 6572  # Decibel conver
+00000e20: 7369 6f6e 0a20 2020 2020 2020 2020 2020  sion.           
+00000e30: 2069 6620 4d49 4e5f 4155 4449 424c 455f   if MIN_AUDIBLE_
+00000e40: 4c45 5645 4c20 3e20 6d61 785f 7265 6164  LEVEL > max_read
+00000e50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00000e60: 2020 6465 6369 6265 6c73 203d 2030 2e30    decibels = 0.0
+00000e70: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00000e80: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00000e90: 2020 2064 6563 6962 656c 7320 3d20 3230     decibels = 20
+00000ea0: 202a 206d 6174 682e 6c6f 6731 3028 6d61   * math.log10(ma
+00000eb0: 785f 7265 6164 2f4d 494e 5f41 5544 4942  x_read/MIN_AUDIB
+00000ec0: 4c45 5f4c 4556 454c 290a 0a20 2020 2020  LE_LEVEL)..     
+00000ed0: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00000ee0: 6572 2e69 6e66 6f28 6622 4465 6369 6265  er.info(f"Decibe
+00000ef0: 6c73 203d 207b 6465 6369 6265 6c73 7d22  ls = {decibels}"
+00000f00: 290a 2020 2020 2020 2020 2020 2020 706f  ).            po
+00000f10: 696e 7473 203d 205b 0a20 2020 2020 2020  ints = [.       
+00000f20: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00000f30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00000f40: 6d65 6173 7572 656d 656e 7422 3a20 2273  measurement": "s
+00000f50: 6f75 6e64 222c 0a20 2020 2020 2020 2020  ound",.         
+00000f60: 2020 2020 2020 2020 2020 2022 7461 6773             "tags
+00000f70: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+00000f80: 2020 2020 2020 2020 2020 2020 2022 736f               "so
+00000f90: 756e 6469 6422 3a20 7365 6c66 2e63 6f6e  undid": self.con
+00000fa0: 6669 675b 2769 6427 5d0a 2020 2020 2020  fig['id'].      
+00000fb0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+00000fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000fd0: 2020 2020 2022 7469 6d65 223a 2064 6174       "time": dat
+00000fe0: 6574 696d 652e 7574 636e 6f77 2829 2c0a  etime.utcnow(),.
 00000ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001000: 2020 2020 2266 6965 6c64 7322 3a20 7b0a      "fields": {.
 00001010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001020: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001030: 2e63 6f6e 6669 675b 2769 6e66 6c75 7864  .config['influxd
-00001040: 6263 6f6e 6e27 5d5b 2774 6f6b 656e 275d  bconn']['token']
-00001050: 2929 0d0a 0d0a 6966 205f 5f6e 616d 655f  ))....if __name_
-00001060: 5f20 3d3d 2022 5f5f 6d61 696e 5f5f 223a  _ == "__main__":
-00001070: 0d0a 2020 2020 7365 6e73 6f72 735f 696e  ..    sensors_in
-00001080: 7374 616e 6365 203d 2053 6f75 6e64 7472  stance = Soundtr
-00001090: 6163 6b28 290d 0a20 2020 2073 656e 736f  ack()..    senso
-000010a0: 7273 5f69 6e73 7461 6e63 652e 7365 6e73  rs_instance.sens
-000010b0: 6f72 5265 6164 2829 0d0a 0d0a 0d0a 0d0a  orRead()........
-000010c0: 0d0a 0d0a                                ....
+00001020: 2020 2020 2020 2020 226d 6178 223a 2066          "max": f
+00001030: 6c6f 6174 286d 6178 5f72 6561 6429 2c0a  loat(max_read),.
+00001040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001050: 2020 2020 2020 2020 226d 6178 5f72 6177          "max_raw
+00001060: 223a 2066 6c6f 6174 286d 6178 5f72 6561  ": float(max_rea
+00001070: 6420 2f20 5348 4f52 545f 4e4f 524d 414c  d / SHORT_NORMAL
+00001080: 495a 4529 2c0a 2020 2020 2020 2020 2020  IZE),.          
+00001090: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+000010a0: 625f 7261 7722 3a20 3230 202a 206d 6174  b_raw": 20 * mat
+000010b0: 682e 6c6f 6731 3028 6d61 785f 7265 6164  h.log10(max_read
+000010c0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000010d0: 2020 2020 2020 2020 2020 2022 6462 223a             "db":
+000010e0: 2066 6c6f 6174 2864 6563 6962 656c 7329   float(decibels)
+000010f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001100: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00001110: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00001120: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00001130: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00001140: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00001150: 6e2e 696e 7365 7274 2822 4448 5432 3222  n.insert("DHT22"
+00001160: 2c20 706f 696e 7473 290a 2020 2020 2020  , points).      
+00001170: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00001180: 6570 7469 6f6e 2061 7320 6578 3a0a 2020  eption as ex:.  
+00001190: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000011a0: 6c66 2e6c 6f67 6765 722e 6572 726f 7228  lf.logger.error(
+000011b0: 6622 5275 6e74 696d 6545 7272 6f72 3a20  f"RuntimeError: 
+000011c0: 7b65 787d 2229 0a20 2020 2020 2020 2020  {ex}").         
+000011d0: 2020 2020 2020 2075 726c 203d 2073 656c         url = sel
+000011e0: 662e 636f 6e66 6967 5b27 696e 666c 7578  f.config['influx
+000011f0: 6462 636f 6e6e 275d 5b27 7572 6c27 5d0a  dbconn']['url'].
+00001200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001210: 746f 6b65 6e20 3d20 7365 6c66 2e63 6f6e  token = self.con
+00001220: 6669 675b 2769 6e66 6c75 7864 6263 6f6e  fig['influxdbcon
+00001230: 6e27 5d5b 2774 6f6b 656e 275d 0a20 2020  n']['token'].   
+00001240: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00001250: 662e 6c6f 6767 6572 2e65 7272 6f72 2866  f.logger.error(f
+00001260: 2269 6e66 6c75 7844 4255 524c 3d7b 7572  "influxDBURL={ur
+00001270: 6c7d 207c 2069 6e66 6c75 7844 4254 6f6b  l} | influxDBTok
+00001280: 656e 3d7b 746f 6b65 6e7d 2229 0a0a 6966  en={token}")..if
+00001290: 205f 5f6e 616d 655f 5f20 3d3d 2022 5f5f   __name__ == "__
+000012a0: 6d61 696e 5f5f 223a 0a20 2020 2073 656e  main__":.    sen
+000012b0: 736f 7273 5f69 6e73 7461 6e63 6520 3d20  sors_instance = 
+000012c0: 536f 756e 6474 7261 636b 2829 0a20 2020  Soundtrack().   
+000012d0: 2073 656e 736f 7273 5f69 6e73 7461 6e63   sensors_instanc
+000012e0: 652e 7365 6e73 6f72 5265 6164 2829 0a0a  e.sensorRead()..
+000012f0: 0a0a 0a0a                                ....
```

### Comparing `pisoundtrack-0.2.2/setup.py` & `pisoundtrack-0.2.3/setup.py`

 * *Files 18% similar despite different names*

```diff
@@ -1,31 +1,32 @@
-import setuptools
-
-with open("README.md", "r", encoding="utf-8") as fh:
-    long_description = fh.read()
-
-setuptools.setup(
-    name="pisoundtrack",
-    version="0.2.2",
-    author="Ismael Raya",
-    author_email="phornee@gmail.com",
-    description="Raspberry Pi Sound tracking and influx output",
-    long_description=long_description,
-    long_description_content_type="text/markdown",
-    url="https://github.com/Phornee/pisoundtrack",
-    packages=setuptools.find_packages(),
-    package_data={
-        '': ['*.yml'],
-    },
-    classifiers=[
-        "Programming Language :: Python :: 3",
-        "License :: OSI Approved :: MIT License",
-        "Operating System :: POSIX :: Linux",
-        "Topic :: Home Automation"
-    ],
-    install_requires=[
-        'baseutils_phornee>=0.0.17',
-        'influxdb>=5.3.1',
-        'numpy>=1.21.5'
-    ],
-    python_requires='>=3.6',
+import setuptools
+
+with open("README.md", "r", encoding="utf-8") as fh:
+    long_description = fh.read()
+
+setuptools.setup(
+    name="pisoundtrack",
+    version="0.2.3",
+    author="Ismael Raya",
+    author_email="phornee@gmail.com",
+    description="Raspberry Pi Sound tracking and influx output",
+    long_description=long_description,
+    long_description_content_type="text/markdown",
+    url="https://github.com/Phornee/pisoundtrack",
+    packages=setuptools.find_packages(),
+    package_data={
+        '': ['*.yml'],
+    },
+    classifiers=[
+        "Programming Language :: Python :: 3",
+        "License :: OSI Approved :: MIT License",
+        "Operating System :: POSIX :: Linux",
+        "Topic :: Home Automation"
+    ],
+    install_requires=[
+        'config_yml>=0.3.1',
+        'log_mgr>=0.0.2',
+        'influxdb>=5.3.1',
+        'numpy>=1.21.5'
+    ],
+    python_requires='>=3.6',
 )
```

